(self.webpackChunkmooz=self.webpackChunkmooz||[]).push([[666],{2660:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Ae}});var o=t(9439),i=t(2791),r=t(8291),a=t(8015),l=t(1413),s=t(4925),c=t(6674),d=t(9707),u=t(184),f=["on","fullbody","dblclick"],m=function(e){var n=e.on,t=e.fullbody,o=e.dblclick,r=(0,s.Z)(e,f),a=(0,i.useRef)(null);return(0,i.useEffect)((function(){if(c.Z.fullscreenEnabled){var e;e=!t&&a.current?a.current:document.body;try{n&&!c.Z.fullscreenElement?c.Z.requestFullscreen(e):!n&&c.Z.fullscreenElement&&c.Z.exitFullscreen()}catch(r){(0,d.ZP)("Fullscreen error",{autoClose:d.V7.SHORT,type:d.pC.error})}var i=function(){if(o)try{!!c.Z.fullscreenElement?c.Z.exitFullscreen():(c.Z.requestFullscreen(e),(0,d.ZP)("Entered into fullscreen mode, double click to toggle",{type:d.pC.info}))}catch(r){(0,d.ZP)("Fullscreen error",{autoClose:d.V7.SHORT,type:d.pC.error})}};return e.addEventListener("dblclick",i),function(){return e.removeEventListener("dblclick",i)}}}),[n,t,o]),(0,u.jsx)("div",(0,l.Z)({ref:a},r))},h=t(8096),p=t(1318),v=t(6570),g=t(7776),x=t(7240),y=t(2110),k=t(3085),C={icon:{fontSize:y.TS.xLarge}},w=(0,y.y0)({backgroundColor:k.iX.gray30,"& :hover":{backgroundColor:k.iX.gray20},"& button, & button:hover":{color:k.iX.black}}),b=(0,y.y0)({backgroundColor:k.iX.gray140,"& :hover":{backgroundColor:k.iX.gray150},"& button, & button:hover":{color:k.iX.white}}),j={root:{padding:"0 .5em",height:"40px"}},N={root:{margin:"auto .5em",transition:"all .1s ease"},rootHovered:{backgroundColor:"#CE0B1B",color:"white"},label:{fontSize:y.TS.mediumPlus,fontWeight:y.lq.regular}},S=t(188),T=t(149),Z=t(7886),P=t(2972),I=t(3934),M=t(6668),E=["showFooter"],z=(0,y.ZC)({container:{padding:"1em"},title:{fontSize:"1.75em",fontWeight:y.lq.semilight,margin:"0"},secondaryTitle:{fontSize:"1em",fontWeight:y.lq.semilight,margin:".25em 0"},body:{margin:".5em 0"},footer:{fontSize:y.TS.smallPlus,marginTop:"2em",textAlign:"center",display:"flex",justifyContent:"space-between"}}),D=function(e){var n=e.showFooter,t=(0,s.Z)(e,E),o=(0,r.sJ)(a.n2),i="".concat(window.location.origin,"/room/").concat(null===o||void 0===o?void 0:o.id);return(0,u.jsxs)(P.U,(0,l.Z)((0,l.Z)({className:z.container,role:"dialog",calloutMaxWidth:400},t),{},{children:[(0,u.jsx)("h1",{className:z.title,children:null===o||void 0===o?void 0:o.name}),(0,u.jsxs)("h2",{className:z.secondaryTitle,children:["Room created by ",(null===o||void 0===o?void 0:o.created_by)||"<Enter your name next time>"]}),(0,u.jsxs)("h2",{className:z.secondaryTitle,children:["ID: ",(0,u.jsx)(I._,{children:null===o||void 0===o?void 0:o.id})]}),(0,u.jsxs)("div",{className:z.body,children:["You can invite people directly to this chat by sharing this link"," ",(0,u.jsx)(I._,{children:i})]}),n&&(0,u.jsxs)("div",{className:z.footer,children:[(0,u.jsxs)("span",{children:["Mooz by"," ",(0,u.jsx)(M.r,{href:"https://github.com/muzam1l",target:"_blank",rel:"nofollow noreferrer noopener",children:"muzam1l"})]}),(0,u.jsx)(M.r,{href:"https://github.com/muzam1l/mooz",target:"_blank",rel:"nofollow noreferrer noopener",children:"Fork me on GitHub"})]})]}))},O=function(e){var n=e.onClickPeople,t=e.onClickChat,s=e.onClickFullscreen,d=(0,h.F)(),f=(0,T.Fg)(),m=(0,T.uC)(),y=(0,r.sJ)(a.aM),k=(0,r.sJ)(a.Ib),P=(0,r.sJ)(a.jd),I=(0,r.sJ)(a.$6),M=(0,x.g)(),E=M.displayMediaStatus,z=M.startDisplayMedia,O=M.stopDisplayMedia,H=(0,x.O)(),R=H.startUserMedia,F=H.stopUserMedia,A=function(){var e=(0,i.useState)(!!c.Z.fullscreenElement),n=(0,o.Z)(e,2),t=n[0],r=n[1];return(0,i.useEffect)((function(){var e=function(){c.Z.fullscreenElement&&!t?r(!0):!c.Z.fullscreenElement&&t&&r(!1)};return c.Z.addEventListener("fullscreenchange",e),function(){return c.Z.removeEventListener("fullscreenchange",e)}}),[t]),{isFullscreen:t}}(),J=A.isFullscreen,L=(0,Z.Z)(),_=!!(0,r.sJ)(a.CZ).find((function(e){return e.isDisplay})),W=(0,i.useState)(!1),V=(0,o.Z)(W,2),B=V[0],K=V[1],X={color:d.palette.neutralDark},Y=[{iconProps:y?{iconName:"Microphone"}:{iconName:"MicOff",style:X},onClick:function(){K(!0),y?F("audioinput").finally((function(){return K(!1)})):R(P.length?P[0]:{kind:"audioinput"}).finally((function(){return K(!1)}))},disabled:B,buttonStyles:C,key:"audioToggle",text:"Audio",tooltipHostProps:{content:"Toggle audio",delay:0},split:!0,subMenuProps:P.length?{items:P.map((function(e){return{key:e.deviceId,text:e.label,iconProps:y===e.deviceId?{iconName:"TVMonitorSelected"}:void 0,onClick:function(){R(e)}}}))}:void 0},{iconProps:k?{iconName:"Video"}:{iconName:"VideoOff",style:X},onClick:function(){K(!0),k?F("videoinput").finally((function(){return K(!1)})):R(I.length?I[0]:{kind:"videoinput"}).finally((function(){return K(!1)}))},disabled:B,buttonStyles:C,key:"videoToggle",text:"Video",tooltipHostProps:{content:"Toggle video",delay:0},split:!0,subMenuProps:I.length?{items:I.map((function(e){return{key:e.deviceId,text:e.label,iconProps:k===e.deviceId?{iconName:"TVMonitorSelected"}:void 0,onClick:function(){R(e)}}}))}:void 0},{key:"screen",text:"Screen",disabled:"on"!==E&&_,iconProps:{iconName:"ScreenCast",style:"on"!==E?X:{}},tooltipHostProps:{content:"on"===E?"Stop sharing":_?"Someone's already sharing screen":"Share your screen",delay:0},onClick:function(){"on"===E?O():z()}},{onClick:t,buttonStyles:C,key:"chat",text:"Chat",iconProps:{iconName:"Chat"},tooltipHostProps:{content:"Open chats",delay:0}},{onClick:n,buttonStyles:C,key:"people",text:"People",iconProps:{iconName:"People"},tooltipHostProps:{content:"Show participants",delay:0}}],q=[{key:"theme",text:"Choose theme",secondaryText:f,iconProps:{iconName:"Contrast"},subMenuProps:{items:[{key:"light",text:"Light",className:w,onClick:function(){return"dark"===f&&(null===m||void 0===m?void 0:m("light"))}},{key:"dark",text:"Dark",className:b,onClick:function(){return"light"===f&&(null===m||void 0===m?void 0:m("dark"))}}]}},{key:"fullscreen",text:"Toggle fullscreen",secondaryText:void 0===J?"":J?"On":"Off",iconProps:{iconName:"Fullscreen"},onClick:function(){return null===s||void 0===s?void 0:s()}}],U=(0,i.useState)(!1),Q=(0,o.Z)(U,2),$=Q[0],G=Q[1],ee=[{commandBarButtonAs:function(e){var n=e.text,t=e.key;return(0,u.jsx)(p.a,{onClick:function(){return L()},text:n,styles:N},t)},key:"leave",text:"Leave"},{buttonStyles:C,className:"commandbar-info-button",key:"info",ariaLabel:"Info",iconOnly:!0,iconProps:{iconName:"Info"},onClick:function(){return G(!$)}}],ne="dark"===f?S.bN:S.hB;return(0,u.jsxs)(v.f,{theme:(0,l.Z)({},ne),children:[(0,u.jsx)(g.X,{styles:j,items:Y,overflowItems:q,overflowButtonProps:{ariaLabel:"More commands"},farItems:ee,ariaLabel:"Use left and right arrow keys to navigate between commands"}),$&&(0,u.jsx)(D,{onDismiss:function(){return G(!1)},target:".commandbar-info-button",showFooter:!0})]})},H=t(3433),R=t(7532),F=t.n(R);function A(e,n,t){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=t,r=n,a=e,l=Math.sqrt(r*a*o/i),s=Math.floor(r*o/l),c=Math.floor(a/l),d=s*c;d<i;)l--,d=(s=Math.floor(r*o/l))*(c=Math.floor(a/l));return{x:l,y:l/o}}var J=t(1005),L=["partnerId","partnerName"],_=function(e){return function(n){return function(e,n){var t="TIAS";return n=1e3*(n>>>0),(e=e.replace(new RegExp("b=TIAS:.*\r\n"),"")).replace(/(m=video.*\r\n)/g,"$1b=".concat(t,":").concat(n,"\r\n"))}(n,e)}},W=function(e){var n=(0,r.Zl)(a.x),t=(0,r.Zl)(a.bv),c=(0,r.sJ)(a.eD),u=e.partnerId,f=e.partnerName,m=(0,s.Z)(e,L),h=(0,r.FV)(a.CZ),p=(0,o.Z)(h,2),v=p[0],g=p[1],x=(0,i.useRef)(new MediaStream),y=(0,r.sJ)(a.qU),k=(0,r.sJ)(a.JQ),C=(0,r.sJ)(a.Cu),w=(0,i.useRef)();if(!w.current){var b,j=((null===(b=window.moozPeers)||void 0===b?void 0:b.length)||0)+1,N=J.CH/Math.sqrt(j);N<J.OV&&(N=J.OV),w.current=new(F())((0,l.Z)({sdpTransform:_(N)},m))}!function(){var e={peer:w.current,partnerId:u};window.moozPeers||(window.moozPeers=[e]),window.moozPeers=window.moozPeers.filter((function(e){return e.partnerId!==u})),window.moozPeers.push(e)}();var S=(0,i.useCallback)((function(e){try{var n,t=JSON.parse(e);"NO_STREAM"===(null===t||void 0===t||null===(n=t.metadata)||void 0===n?void 0:n.state)&&(x.current.getTracks().forEach((function(e){e.stop(),x.current.removeTrack(e)})),g(v.filter((function(e){return e.partnerId!==u}))))}catch(o){}}),[v,g,u]),T=(0,i.useCallback)((function(e,n){var o=x.current;console.log(e),console.log(n),n||o.getTracks().forEach((function(e){"video"===e.kind&&e.stop(),o.removeTrack(e)}));var i=[],r=e.getVideoTracks()[1];if(r){e.removeTrack(r);var a=new MediaStream([r]);if(v.find((function(e){return e.isDisplay&&e.partnerId===u&&e.stream.getVideoTracks().find((function(e){return e.id===r.id&&e.enabled&&"live"===e.readyState}))})))return;i.push({stream:a,isDisplay:!0,partnerId:u,partnerName:f})}e.getTracks().forEach((function(e){n&&o.getTracks().find((function(n){return n.id===e.id}))||o.addTrack(e)})),i.unshift({stream:o,partnerId:u,partnerName:f}),t(i)}),[t,v,u,f]),Z=(0,i.useCallback)((function(e,n){var t,o,i,r,a,l=null===(t=window.moozPeers)||void 0===t||null===(o=t.find((function(e){return e.partnerId===u})))||void 0===o?void 0:o.peer,s=null===l||void 0===l||null===(i=l._remoteStreams)||void 0===i?void 0:i.find((function(e){return e.active}));if(s&&s.id===n.id){var c=(null===l||void 0===l||null===(r=l._remoteTracks)||void 0===r?void 0:r.filter((function(e){return e.stream.id===s.id})).map((function(e){return e.track})).filter((function(e){return e.enabled&&"live"===e.readyState})))||[];c.find((function(n){return n.id===e.id}))||(c=c.concat(e));var d=[].concat((0,H.Z)(x.current.getTracks()),[null===(a=v.find((function(e){return e.isDisplay&&e.partnerId===u})))||void 0===a?void 0:a.stream.getVideoTracks()[0]]).filter(Boolean);if(c.length>d.length){var f=new MediaStream(c);T(f,!0)}}}),[T,v,u]);return(0,i.useEffect)((function(){var e=w.current,t=function(n){var t=n.signal,o=n.from;if(t&&o===u)try{e.signal(t)}catch(i){}},o=function(){(0,d.ZP)("Connected with peer ".concat(f),{type:d.pC.success})},i=function(){(0,d.ZP)("Connection closed with peer ".concat(f),{type:d.pC.severeWarning}),C.emit("person_left",{sessionId:u})},r=function(e){"ERR_WEBRTC_SUPPORT"===e.code?(0,d.ZP)("No WebRTC support, are you on grandpa's computer?",{type:d.pC.error}):"ERR_CONNECTION_FAILURE"===e.code&&(0,d.ZP)("WebRTC connection failure",{type:d.pC.error})},a=function(e){C.send({to:u,signal:e})},s=function(e){try{var t=JSON.parse(e);if(null!==t&&void 0!==t&&t.message){var o=(0,l.Z)((0,l.Z)({},null===t||void 0===t?void 0:t.message),{},{mine:!1});n([o]),(0,d.ZP)("New message from ".concat(null===o||void 0===o?void 0:o.author,": ").concat(null===o||void 0===o?void 0:o.text),{type:d.pC.info})}}catch(i){(0,d.ZP)("Peer data error",{type:d.pC.error,autoClose:d.V7.SHORT})}};return e.on("stream",T),e.on("signal",a),e.on("connect",o),e.on("close",i),e.on("error",r),e.on("track",Z),C.on("message",t),function(){e.off("stream",T),e.off("signal",a),e.off("connect",o),e.off("data",s),e.off("data",S),e.off("close",i),e.off("error",r),e.off("track",Z),C.off("message",t)}}),[T,C,u,n,S,Z,f]),(0,i.useEffect)((function(){var e=w.current,n=null===k||void 0===k?void 0:k.getVideoTracks(),t=[].concat((0,H.Z)((null===y||void 0===y?void 0:y.getTracks())||[]),(0,H.Z)(n||[]));null===n||void 0===n||!n.length||null!==y&&void 0!==y&&y.getVideoTracks().length||t.unshift(function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.width,o=void 0===t?640:t,i=n.height,r=void 0===i?480:i,a=Object.assign(document.createElement("canvas"),{width:o,height:r});null===(e=a.getContext("2d"))||void 0===e||e.fillRect(0,0,o,r);var l=a.captureStream();return Object.assign(l.getVideoTracks()[0],{enabled:!1})}());var o=new MediaStream(t);try{if(t.length)e.addStream(o);else{e.send(JSON.stringify({metadata:{state:"NO_STREAM"}}))}}catch(i){}return function(){try{e.removeStream(o)}catch(i){}}}),[y,k]),(0,i.useEffect)((function(){m.initiator||C.send({to:u,proposal:!0,name:c.name})}),[]),(0,i.useEffect)((function(){return function(){var e;null===(e=w.current)||void 0===e||e.destroy(),x.current.getTracks().forEach((function(e){e.stop(),x.current.removeTrack(e)}))}}),[]),null},V=function(){var e=(0,r.Zl)(a.RH),n=(0,r.FV)(a.hF),t=(0,o.Z)(n,2),l=t[0],s=t[1],c=(0,r.sJ)(a.Cu);console.log("Connection index file..."),console.log(c),console.log(l),console.log("Connection index file...");var f=(0,i.useCallback)((function(n){var t=n.sessionId,o=n.name;e([{partnerId:t,partnerName:o,initiator:!1}])}),[e]),m=(0,i.useCallback)((function(n){var t=n.proposal,o=n.from,i=n.name;t&&e([{partnerId:o,initiator:!0,partnerName:i}])}),[e]),h=(0,i.useCallback)((function(e){var n=e.sessionId,t=l.find((function(e){return e.partnerId===n}));t&&(0,d.ZP)("".concat(null===t||void 0===t?void 0:t.partnerName," left the meeting")),s(l.filter((function(e){return e.partnerId===n})))}),[s,l]);return(0,i.useEffect)((function(){return c.on("person_joined",f),function(){c.off("person_joined",f)}}),[f,c]),(0,i.useEffect)((function(){return c.on("message",m),function(){c.off("message",m)}}),[m,c]),(0,i.useEffect)((function(){return c.on("person_left",h),function(){c.off("person_left",h)}}),[h,c]),(0,u.jsx)(u.Fragment,{children:l.map((function(e){return(0,u.jsx)(W,{partnerName:e.partnerName,initiator:e.initiator,partnerId:e.partnerId},e.partnerId)}))})},B=t(9332),K=t(7137),X=t(5080),Y=t(6933),q=t(3998),U=t(2889),Q=t(9093),$=t(6159),G=(0,y.y0)({height:"100%"}),ee=(0,y.y0)({height:"100%",overflowY:"auto",overflowX:"hidden"}),ne=(0,y.y0)({margin:".15em .5em",fontWeight:y.lq.semilight}),te=(0,y.y0)({width:"100%"}),oe=(0,y.y0)({display:"flex",flexDirection:"column-reverse",height:"100%"}),ie={root:{height:"44px",display:"flex",justifyContent:"center",margin:".25em"},itemContainer:{height:"calc(100% - 44px) ","& > div":{height:"100%"}}},re={scrollableContent:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},content:{display:"flex",flexDirection:"column",height:"100%",padding:".25em"}},ae=(0,y.y0)({height:"100%",fontSize:y.TS.xLarge,fontWeight:y.lq.semilight,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:".25em",textAlign:"center"}),le=(0,$.Z)((function(e){return{container:{display:"flex",flexFlow:"column nowrap",alignItems:"stretch",maxWidth:"700px",maxHeight:"500px"},header:[{flex:"1 1 auto",borderTop:"4px solid ".concat(e.palette.themePrimary),color:e.palette.neutralPrimary,display:"flex",alignItems:"center",padding:".25em .75em",cursor:"move",fontWeight:y.lq.semilight,fontSize:y.TS.xxLarge}],body:{flex:"4 4 auto",padding:"0 1em",overflowY:"auto",height:"100%",width:"500px"}}})),se={scrollableContent:{display:"flex",flexDirection:"column",height:"100%"}},ce=(0,$.Z)((function(e){return{root:{color:e.palette.neutralPrimary,marginLeft:"auto",marginTop:"4px",marginRight:"2px"},rootHovered:{color:e.palette.neutralDark}}})),de=((0,y.y0)({margin:".5em auto",width:"100%"}),t(4026)),ue=(0,y.y0)({width:"100%"}),fe=(0,y.ZC)({container:{padding:".25em",width:"100%",height:"100%",overflowY:"auto"},children:{overflowY:"auto",width:"100%",height:"100%"},type:{overflowY:"auto",overflowX:"hidden",width:"100%",maxHeight:"100%",display:"flex",flexDirection:"row",alignItems:"flex-end",padding:".5em 0"},info:{fontWeight:y.lq.semilight,textAlign:"center"}}),me=(0,$.Z)((function(e){return{container:{width:"100%",margin:".25em 0",display:"flex",flexDirection:"row",position:"relative"},message:{backgroundColor:e.palette.neutralQuaternary,display:"flex",flexDirection:"column",padding:".5em 1em",borderRadius:"1px"},title:{fontWeight:y.lq.light,fontSize:y.TS.small,fontFamily:"monospace",width:"200px",textOverflow:"ellipsis"},text:{maxWidth:"100%",wordBreak:"break-word"}}})),he={backgroundColor:k.UP.cyanBlue10,marginLeft:"auto",color:"white"},pe=function(e){var n=e.mine,t=e.text,o=e.title,i=me();return(0,u.jsx)("div",{className:i.container,children:(0,u.jsxs)("div",{style:n?he:void 0,className:i.message,children:[(0,u.jsx)(de.x,{className:i.title,block:!0,nowrap:!0,children:o}),(0,u.jsx)("div",{className:i.text,children:t})]})})},ve=t(3860),ge=t(5984),xe=function(e){var n=e.children,t=(0,r.Zl)(a.x),l=(0,r.sJ)(a.eD).name,s=(0,i.useState)(""),c=(0,o.Z)(s,2),d=c[0],f=c[1],m=(0,i.useRef)(null);(0,i.useEffect)((function(){!function(){var e=m.current;null===e||void 0===e||e.scrollTo(0,null===e||void 0===e?void 0:e.scrollHeight)}()}),[n]);var h=(0,i.useCallback)((function(){if(d.trim()){var e={id:(0,ge.x0)(),mine:!0,text:d,author:l};t([e]),f("")}}),[d,t,l]);return(0,u.jsxs)(B.K,{verticalFill:!0,verticalAlign:"space-between",className:fe.container,children:[(0,u.jsx)("div",{ref:m,className:fe.children,children:n}),(0,u.jsxs)(B.K.Item,{disableShrink:!0,className:fe.type,children:[(0,u.jsx)(ve.n,{className:ue,multiline:!0,autoAdjustHeight:!0,placeholder:"Type message",value:d,onChange:function(e,n){return void 0!==n&&f(n)},onKeyPress:function(e){e.shiftKey&&"Enter"===e.key&&h()}}),(0,u.jsx)(Q.h,{onClick:h,title:"Send (shift+enter)",iconProps:{iconName:"Send"}})]})]})},ye=function(e){var n=e.setPanel,t=(0,r.sJ)(a.aH),l=(0,i.useState)(!1),s=(0,o.Z)(l,2),c=s[0],d=s[1],f=le(),m=ce(),h=window.matchMedia("(max-width: 480px)").matches,v=(0,i.useCallback)((function(){return(0,u.jsxs)(xe,{children:[t.map((function(e){return(0,u.jsx)(pe,{title:e.author,text:e.text,mine:e.mine},e.id)})),!t.length&&(0,u.jsx)("div",{className:ae,children:"Chat is empty"})]})}),[t]),g=(0,i.useCallback)((function(){return(0,u.jsxs)(q.u,{styles:se,allowTouchBodyScroll:!0,titleAriaId:"chat-modal-title",isOpen:c,onDismiss:function(){return d(!1)},isModeless:!0,containerClassName:f.container,dragOptions:{moveMenuItemText:"Move",closeMenuItemText:"Close",menu:U.r,dragHandleSelector:"#chat-modal-header"},children:[(0,u.jsxs)("div",{id:"chat-modal-header",className:f.header,children:[(0,u.jsx)("span",{id:"chat-modal-title",children:"Chat"}),(0,u.jsx)(Q.h,{title:"Minimize",styles:m,iconProps:{iconName:"Cancel"},ariaLabel:"Minimize chat modal",onClick:function(){return d(!1)}})]}),(0,u.jsx)("div",{className:f.body,children:v()})]})}),[c,v,f,m]);return(0,u.jsxs)(B.K,{verticalAlign:"center",className:G,children:[!c&&!h&&(0,u.jsx)(Q.h,{title:"Undock",onClick:function(){null===n||void 0===n||n(""),d(!0)},text:"Undock",iconProps:{iconName:"MiniExpandMirrored"},style:{margin:".25em auto"}}),!c&&(0,u.jsx)(B.K.Item,{className:ee,children:v()}),c&&(0,u.jsxs)(B.K,{verticalAlign:"center",horizontalAlign:"center",className:ae,children:["Chats are open in floating Modal",(0,u.jsx)(p.a,{onClick:function(){return d(!1)},text:"Open chats here",style:{marginTop:".5em"}})]}),g()]})},ke=t(4337),Ce=t(6986),we=t(8933),be=t(2955),je=function(e){var n=e.index,t=e.item,r=(0,i.useState)(null),a=(0,o.Z)(r,2),l=a[0],s=a[1],c=(0,h.F)(),f=(0,i.useState)(ke.H_.away),m=(0,o.Z)(f,2),p=m[0],v=m[1];if((0,i.useEffect)((function(){var e,n=function(){return v(ke.H_.online)},o=function(){return v(ke.H_.offline)},i=((null===(e=window.moozPeers)||void 0===e?void 0:e.find((function(e){return e.partnerId===(null===t||void 0===t?void 0:t.partnerId)})))||{}).peer;return null===i||void 0===i||i.on("connect",n),null===i||void 0===i||i.on("close",o),function(){null===i||void 0===i||i.off("connect",n),null===i||void 0===i||i.off("close",o)}}),[t]),!t||void 0===n)return null;var g=function(){(0,d.ZP)("Not Implemented yet",{autoClose:d.V7.SHORT,type:d.pC.severeWarning})};return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(B.K,{onContextMenu:function(e){e.preventDefault(),s(e)},styles:{root:{padding:".5em .75em",cursor:"default",":hover":{backgroundColor:c.semanticColors.listItemBackgroundHovered}}},horizontal:!0,horizontalAlign:"space-between",children:[(0,u.jsx)(Ce.I,{presence:p,text:t.partnerName||"<".concat(t.partnerId,">"),secondaryText:"Online",size:ke.Ir.size32}),(0,u.jsx)(Q.h,{onClick:function(e){s(e)},iconProps:{iconName:"More"}})]},t.partnerId),(0,u.jsx)(U.r,{items:[{key:"header1",itemType:we.n.Header,text:t.partnerName},{key:"mute",text:"Mute",iconProps:{iconName:"MicOff"},onClick:g},{key:"hide",text:"Hide",iconProps:{iconName:"VideoOff"},onClick:g},{key:"divider1",itemType:we.n.Divider},{key:"kick",text:"Kick out",iconProps:{iconName:"SignOut"},onClick:g}],onDismiss:function(){s(null)},hidden:!l,target:l})]})},Ne=function(){var e=(0,r.sJ)(a.rN),n=(0,i.useCallback)((function(e,n){return(0,u.jsx)(je,{item:e,index:n})}),[]),t=(0,i.useState)(!1),l=(0,o.Z)(t,2),s=l[0],c=l[1],f=(0,i.useRef)();return(0,i.useEffect)((function(){e.length||f.current?e.length&&f.current&&f.current&&((0,d.Xd)(f.current),f.current=void 0):f.current=(0,d.ZP)("You are curently alone \ud83d\udca9, make some friends and then invite them!",{autoClose:d.V7.PERSIST,type:d.pC.info})}),[e]),(0,i.useEffect)((function(){return function(){f.current&&(0,d.Xd)(f.current)}}),[]),(0,u.jsxs)(B.K,{verticalAlign:"center",className:G,children:[e.length?(0,u.jsxs)(B.K,{className:G,horizontalAlign:"center",children:[(0,u.jsx)(p.a,{onClick:function(){return c(!s)},text:"Info",className:"info-button-in-person-list",style:{marginBottom:".5em"}}),(0,u.jsx)(be.a,{style:{width:"100%"},className:ee,items:e,onRenderCell:n})]}):(0,u.jsxs)("div",{className:ae,children:[(0,u.jsx)("span",{children:"You are currently alone right now, invite some people to join"}),(0,u.jsx)(p.a,{onClick:function(){return c(!s)},text:"Info",className:"info-button-in-person-list",style:{marginTop:".5em"}})]}),s&&(0,u.jsx)(D,{onDismiss:function(){return c(!1)},target:".info-button-in-person-list"})]})},Se=function(e){var n=e.panel,t=e.onDismiss,o=e.setPanel,r=n&&n[0].toLocaleUpperCase()+n.slice(1),a=(0,i.useCallback)((function(e,n){return(0,u.jsxs)(B.K,{className:te,horizontal:!0,horizontalAlign:"space-between",children:[(0,u.jsx)("h1",{className:ne,children:r}),null===n||void 0===n?void 0:n(e)]})}),[r]);return(0,u.jsx)("div",{children:(0,u.jsx)(K.s,{styles:re,onRenderNavigationContent:a,isHiddenOnDismiss:!0,isBlocking:!1,isOpen:!!n,onDismiss:t,closeButtonAriaLabel:"Close",isFooterAtBottom:!0,children:(0,u.jsxs)(X.o,{selectedKey:n,onLinkClick:function(e){var n=null===e||void 0===e?void 0:e.props.itemKey;n&&o(n)},className:oe,styles:ie,"aria-label":"Switch between Chat and People list",children:[(0,u.jsx)(Y.M,{alwaysRender:!0,itemKey:"people",itemIcon:"People",headerText:"People",children:(0,u.jsx)(Ne,{})}),(0,u.jsx)(Y.M,{alwaysRender:!0,itemKey:"chat",itemIcon:"Chat",headerText:"Chat",children:(0,u.jsx)(ye,{setPanel:o})})]})})})},Te=(0,y.y0)({height:"calc(100vh - 40px)",display:"flex",overflowY:"auto",width:"100%"}),Ze=(0,y.y0)({display:"flex",margin:"auto",flexDirection:"row",justifyContent:"center",alignItems:"center",flexWrap:"wrap",width:"100%"}),Pe=(0,y.y0)({position:"fixed",bottom:0,height:150,width:200,zIndex:100}),Ie=(0,y.y0)(Pe,{right:0}),Me=(0,y.y0)(Pe,{right:200}),Ee={main:{minHeight:100,minWidth:100,height:"100%",maxHeight:"100%",width:"100%",maxWidth:"100%",display:"flex"}},ze=(0,y.y0)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",width:"100%","@media (max-width: 768px)":{flexDirection:"column"}}),De=(0,y.y0)({display:"flex",flexDirection:"column",height:"100%",flexShrink:0,width:"min-content",overflowY:"auto",alignItems:"center",justifyContent:"center","@media (max-width: 768px)":{flexDirection:"row",width:"100%",height:"min-content",overflowX:"auto"}}),Oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=(0,i.useState)({}),r=(0,o.Z)(t,2),a=r[0],l=r[1],s=(0,i.useState)(window.matchMedia("(max-width: 480px)").matches),c=(0,o.Z)(s,2),d=c[0],u=c[1];(0,i.useEffect)((function(){var e=function(e){e.matches?u(!0):u(!1)};return window.matchMedia("(max-width: 480px)").addEventListener("change",e),function(){return window.matchMedia("(max-width: 480px)").removeEventListener("change",e)}}),[u]),(0,i.useEffect)((function(){var e=function(){if(!d){var e=window.innerHeight-40,n=window.innerWidth;l({X:n,Y:e})}},n=window.innerHeight-40,t=window.innerWidth;return l({X:t,Y:n}),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[d,l]);var f=a.X,m=void 0===f?500:f,h=a.Y,p=void 0===h?800:h,v=A(m,p,e,n),g=v.x,x=v.y;return{x:g,y:x,X:m,Y:p}},He=t(3038),Re=4/3,Fe=function(){var e=(0,h.F)(),n=(0,r.sJ)(a.qU),t=(0,r.sJ)(a.JQ),l=(0,r.sJ)(a.CZ),s=(0,i.useState)(),c=(0,o.Z)(s,2),d=c[0],f=c[1],m=l.find((function(e){return e.isDisplay}));(0,i.useEffect)((function(){f(m||void 0)}),[m]);var p=Oe(l.length,Re),v=p.x,g=p.y,x=p.X;return(0,u.jsxs)("div",{style:{backgroundColor:e.semanticColors.bodyBackground},className:Te,children:[!d&&(0,u.jsx)("div",{className:Ze,children:l.map((function(e){var n=e.stream,t=e.partnerName;return(0,u.jsx)(B.K,{style:{height:g,maxWidth:v},children:(0,u.jsx)(He.Z,{label:t,stream:n})},n.id)}))}),d&&(0,u.jsxs)("div",{className:ze,children:[(0,u.jsx)(B.K,{disableShrink:!0,verticalFill:!0,style:{width:x>768?x-200:x},children:(0,u.jsx)(He.Z,{label:d.partnerName,stream:d.stream})},d.stream.id),(0,u.jsx)("div",{className:De,children:l.filter((function(e){return!e.isDisplay||e.partnerId!==d.partnerId})).map((function(e){var n=e.stream,t=e.partnerName;return(0,u.jsx)(B.K,{style:{height:150,width:200},children:(0,u.jsx)(He.Z,{stream:n,label:t})},n.id)}))})]}),(0,u.jsx)("div",{className:Ie,id:"user-media-container"}),(0,u.jsx)("div",{className:Me,id:"display-media-container"}),t&&(0,u.jsx)(q.u,{isBlocking:!0,isModeless:!0,isOpen:!0,styles:Ee,layerProps:{hostId:"display-media-container"},dragOptions:{moveMenuItemText:"Move",closeMenuItemText:"Close",menu:U.r},children:(0,u.jsx)(He.Z,{muted:!0,stream:t,label:"You are sharing your screen",noContextualMenu:!0})}),n&&(0,u.jsx)(q.u,{isBlocking:!0,isModeless:!0,isOpen:!0,styles:Ee,layerProps:{hostId:"user-media-container"},dragOptions:{moveMenuItemText:"Move",closeMenuItemText:"Close",menu:U.r},children:(0,u.jsx)(He.Z,{muted:!0,stream:n,label:"You",noContextualMenu:!0})})]})},Ae=function(){var e=(0,r.sJ)(a.n2),n=(0,i.useState)(""),t=(0,o.Z)(n,2),l=t[0],s=t[1],c=(0,i.useState)(!1),d=(0,o.Z)(c,2),f=d[0],h=d[1];return(0,i.useEffect)((function(){return document.title=(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.created_by)&&"Meeting by ".concat(null===e||void 0===e?void 0:e.created_by)||"A Mooz meeting",function(){document.title="Mooz"}}),[e]),(0,u.jsxs)(m,{on:f,dblclick:!0,fullbody:!0,children:[(0,u.jsx)(O,{onClickFullscreen:function(){return h(!f)},onClickChat:function(){return s("chat"!==l?"chat":"")},onClickPeople:function(){return s("people"!==l?"people":"")}}),(0,u.jsx)(Fe,{}),(0,u.jsx)(Se,{setPanel:s,panel:l,onDismiss:function(){return s("")}}),(0,u.jsx)(V,{})]})}},2361:function(){},4616:function(){}}]);
//# sourceMappingURL=666.53a636a7.chunk.js.map